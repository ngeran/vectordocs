"use strict";(globalThis.webpackChunkvectordocs=globalThis.webpackChunkvectordocs||[]).push([[4893],{8453(e,n,t){t.d(n,{R:()=>i,x:()=>c});var r=t(6540);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}},9754(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"routing/bgp/bgp-route-selection/index","title":"Route Selection","description":"Before the router even starts the route selection process it needs to make sure that the route is valid, checks the Martian routes, AS loops and next-hop reachability.","source":"@site/docs/routing/bgp/bgp-route-selection/index.md","sourceDirName":"routing/bgp/bgp-route-selection","slug":"/routing/bgp/bgp-route-selection","permalink":"/VectorDocs/docs/routing/bgp/bgp-route-selection","draft":false,"unlisted":false,"editUrl":"https://github.com/ngeran/VectorDocs/tree/main/docs/routing/bgp/bgp-route-selection/index.md","tags":[{"inline":true,"label":"BGP","permalink":"/VectorDocs/docs/tags/bgp"},{"inline":true,"label":"Routing","permalink":"/VectorDocs/docs/tags/routing"},{"inline":true,"label":"Juniper","permalink":"/VectorDocs/docs/tags/juniper"}],"version":"current","frontMatter":{"slug":"/routing/bgp/bgp-route-selection","title":"Route Selection","date":"2024-12-01T14:15:27.000Z","draft":false,"tags":["BGP","Routing","Juniper"],"featured_image":"featured.png","summary":"How to influance the route selection with the approptiate attributes."},"sidebar":"docsSidebar","previous":{"title":"BGP Attributes","permalink":"/VectorDocs/docs/routing/bgp/bgp-attributes"},"next":{"title":"Finite State Machine","permalink":"/VectorDocs/docs/routing/bgp/fsm"}}');var o=t(4848),s=t(8453);const i={slug:"/routing/bgp/bgp-route-selection",title:"Route Selection",date:new Date("2024-12-01T14:15:27.000Z"),draft:!1,tags:["BGP","Routing","Juniper"],featured_image:"featured.png",summary:"How to influance the route selection with the approptiate attributes."},c=void 0,d={},l=[{value:"Best Path Selection",id:"best-path-selection",level:2},{value:"Lowest Route Preference",id:"lowest-route-preference",level:2},{value:"Highest Local Preference",id:"highest-local-preference",level:2},{value:"Shortest AS Path",id:"shortest-as-path",level:2},{value:"Lowest Origin",id:"lowest-origin",level:2},{value:"Lowest MED",id:"lowest-med",level:2},{value:"Route Type",id:"route-type",level:2},{value:"Lowest IGP cost",id:"lowest-igp-cost",level:2},{value:"Lowest R-ID or Oldest Active",id:"lowest-r-id-or-oldest-active",level:2},{value:"Cluster List",id:"cluster-list",level:2},{value:"Lowest Peer IP",id:"lowest-peer-ip",level:2}];function a(e){const n={blockquote:"blockquote",br:"br",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Before the router even starts the route selection process it needs to make sure that the route is valid, checks the ",(0,o.jsx)(n.strong,{children:"Martian"})," routes, ",(0,o.jsx)(n.strong,{children:"AS loops"})," and ",(0,o.jsx)(n.strong,{children:"next-hop reachability"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"best-path-selection",children:"Best Path Selection"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{style:{textAlign:"left"},children:"Attribute"}),(0,o.jsx)(n.th,{style:{textAlign:"left"},children:"Preference"}),(0,o.jsx)(n.th,{style:{textAlign:"left"},children:"Default Behavior"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"1. Route Preference"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Lowest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Default value is 170"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"2. Local Preference"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Highest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Default learned value is 100"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"3. AS-Path"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Shortest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Usualy the first time route selection occurs"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"4. Origin"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Lowest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"IGP (I) >  EGP (E), EGP > incomplete (?)"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"5. Multi Exit Discriminator (MED)"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Lowest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Compared when routes are learned from the same AS"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"6. Route Type"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"External"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Internal vs External, External prefered"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"7. IGP Cost"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Lowest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"lowest cost towards the BGP next-hop"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"8. Internal vs External"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Lowest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Lowest R-ID,  Oldest active route"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"10. Cluster List"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Shortest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"When route reflection is used"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"11. Peer IP Address"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Lowest"}),(0,o.jsx)(n.td,{style:{textAlign:"left"},children:"Multiple peerings between the same router"})]})]})]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"For JUNOS the route selection results and criteria can be seen in the output of:"}),"\n"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"show route details"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"show route extensive"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"lowest-route-preference",children:"Lowest Route Preference"}),"\n",(0,o.jsx)(n.p,{children:"The Juniper default BGP preference is 170 below you can see a route selection which is based on a non-default route preference of 160.\nJunos OS is kind enough to tell us why the second route has lost in the route selection."}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["The Inactive Reason is ",(0,o.jsx)(n.strong,{children:"Route Preference"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.250.0/24 exact detail       \n\ninet.0: 14 destinations, 15 routes (14 active,0 holddown,0 hidden)\n192.168.250.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 160/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 2\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0,selected\n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 7 \n                Validation State: unverified\n                Task: BGP_64522.10.100.34.1\n                Announcement bits(2):0-KRT 4-BGP_RT_Background\n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.3\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router,Next hop index: 596\n                Address: 0xc4b5ef4\n                Next-hop reference count: 1\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0,selected\n                Session Id: 0x140\n                State: <Ext>\n                Inactive reason: Route Preference\n                Local AS: 64533 Peer AS: 64522\n                Age: 9:18 \n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n"})}),"\n",(0,o.jsx)(n.h2,{id:"highest-local-preference",children:"Highest Local Preference"}),"\n",(0,o.jsxs)(n.p,{children:["The default BGP ",(0,o.jsx)(n.strong,{children:"Local Preference"})," is 100 the route below has been selected for its higher non-default value of ",(0,o.jsx)(n.strong,{children:"200"}),"."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["The Inactive Reason is ",(0,o.jsx)(n.strong,{children:"Local Preference"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.250.0/24 exact detail \n\ninet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)\n192.168.250.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-201\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 2\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 24 \n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 I \n                Accepted\n                Localpref: 200\n                Router ID: 10.100.100.3\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 596\n                Address: 0xc4b5ef4\n                Next-hop reference count: 1\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0, selected\n                Session Id: 0x140\n                State: <Ext>\n                Inactive reason: Local Preference\n                Local AS: 64533 Peer AS: 64522\n                Age: 51:52 \n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n"})}),"\n",(0,o.jsx)(n.h2,{id:"shortest-as-path",children:"Shortest AS Path"}),"\n",(0,o.jsxs)(n.p,{children:["The route below has been selected because of its shortest AS Path.",(0,o.jsx)(n.br,{}),"\n","The selected route has 1 AS vs 5 AS."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["The Inactive Reason is ",(0,o.jsx)(n.strong,{children:"AS Path"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.250.0/24 exact detail \n\ninet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)\n192.168.250.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 596\n                Address: 0xc4b5ef4\n                Next-hop reference count: 2\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0, selected\n                Session Id: 0x140\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:23:04 \n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 1\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Session Id: 0x141\n                State: <Ext>\n                Inactive reason: AS path\n                Local AS: 64533 Peer AS: 64522\n                Age: 15 \n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                AS path: 64522 64522 64522 64522 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.3\n                Thread: junos-main \n"})}),"\n",(0,o.jsx)(n.h2,{id:"lowest-origin",children:"Lowest Origin"}),"\n",(0,o.jsx)(n.p,{children:"The active route is chosen based on its lower origin setting of I (IGP), compared to the second route which has an origin of ? (Incomplete)."}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["The inactive reason is ",(0,o.jsx)(n.strong,{children:"Origin"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.250.0/24 exact detail    \n\ninet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)\n192.168.250.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 596\n                Address: 0xc4b5ef4\n                Next-hop reference count: 2\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0, selected\n                Session Id: 0x140\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:45:36 \n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 1\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Session Id: 0x141\n                State: <Ext Changed>\n                Inactive reason: Origin\n                Local AS: 64533 Peer AS: 64522\n                Age: 10 \n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                AS path: 64522 ? \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.3\n                Thread: junos-main \n"})}),"\n",(0,o.jsx)(n.h2,{id:"lowest-med",children:"Lowest MED"}),"\n",(0,o.jsxs)(n.p,{children:["The active route has a MED value of 20 shown as metric in the output.",(0,o.jsx)(n.br,{}),"\n","The second route has a MED of 150."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Inactive reason ",(0,o.jsx)(n.strong,{children:"Not Best in its group - Route Metric or MED comparison"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jjcluser@vMX4# run show route 192.168.250.0/24 exact detail       \n\ninet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)\n192.168.250.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 2\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 36:03 Metric: 20 \n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.3\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 596\n                Address: 0xc4b5ef4\n                Next-hop reference count: 1\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0, selected\n                Session Id: 0x140\n                State: <NotBest Ext>\n                Inactive reason: Not Best in its group - \n                                 Route Metric or MED comparison\n                Local AS: 64533 Peer AS: 64522\n                Age: 13 Metric: 150 \n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main\n"})}),"\n",(0,o.jsx)(n.h2,{id:"route-type",children:"Route Type"}),"\n",(0,o.jsxs)(n.p,{children:["The directly adverised external route is preferred over the external route learned via an internal neighbor.\nThis can be seen from the Local AS and Peer AS line.",(0,o.jsx)(n.br,{}),"\n","The ",(0,o.jsx)(n.strong,{children:"Local AS"})," and ",(0,o.jsx)(n.strong,{children:"Peer AS"})," line gives information on if the route is learned from an",(0,o.jsx)(n.br,{}),"\n","internal or external neighbor.",(0,o.jsx)(n.br,{}),"\n","The order of preference is:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Local redistributed routes into BGP ",(0,o.jsx)(n.strong,{children:"(Interior)"})]}),"\n",(0,o.jsxs)(n.li,{children:["External route directly learned from External BGP peers ",(0,o.jsx)(n.strong,{children:"(Exterior)"})]}),"\n",(0,o.jsxs)(n.li,{children:["External route learned through an Internal BGP peer ",(0,o.jsx)(n.strong,{children:"(Exterior via Interior)"})]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Inactive reason ",(0,o.jsx)(n.strong,{children:"Interior > Exterior > Exterior via Interior"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX6# run show route 192.168.250.0/24 exact detail \n\ninet.0: 11 destinations, 12 routes (11 active, 0 holddown, 0 hidden)\n192.168.250.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 587\n                Address: 0xc4b5dbc\n                Next-hop reference count: 2\n                Source: 10.100.46.1\n                Next hop: 10.100.46.1 via ge-0/0/3.0, selected\n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64544 Peer AS: 64533\n                Age: 50 \n                Validation State: unverified \n                Task: BGP_64533.10.100.46.1\n                Announcement bits (3):0-KRT 4-BGP_RT_Background \n                                     5-Resolve tree 1 \n                AS path: 64533 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.4\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Indirect, Next hop index: 0\n                Address: 0xc4b5d54\n                Next-hop reference count: 1\n                Source: 10.100.100.5\n                Next hop type: Router, Next hop index: 349\n                Next hop: 100.123.0.1 via fxp0.0, selected\n                Session Id: 0x0\n                Protocol next hop: 10.100.25.1\n                Indirect next hop: 0xc61de84 338 INH Session ID: 0x0\n                State: <Int Ext>\n                Inactive reason: Interior > \n                                 Exterior > \n                                 Exterior via Interior\n                Local AS: 64544 Peer AS: 64544\n                Age: 6:58 Metric2: 0 \n                Validation State: unverified \n                Task: BGP_64544.10.100.100.5\n                AS path: 64522 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.5\n                Thread: junos-main \n\n"})}),"\n",(0,o.jsx)(n.h2,{id:"lowest-igp-cost",children:"Lowest IGP cost"}),"\n",(0,o.jsxs)(n.p,{children:["The active route is chosen based on the lowest IGP cost to the BGP next-hop, shown as protocol next-hop in the output.\nThe IGP cost is shown as metric2 in the output.",(0,o.jsx)(n.br,{}),"\n","The active route has a metric2 of 5 vs metric2 of 10 for the inactive."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Inactive reason ",(0,o.jsx)(n.strong,{children:"IGP metric"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.252.0/24 exact detail    \n\ninet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)\n192.168.252.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 3\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Next hop: 10.100.24.1 via ge-0/0/1.0 \n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 16:59       Metric2: 5\n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.3\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Address: 0xc4b5fc4\n                Next-hop reference count: 2\n                Source: 10.100.24.1\n                Next hop type: Router, Next hop index: 0\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Next hop: 10.100.24.1 via ge-0/0/1.0 \n                Session Id: 0x0\n                State: <NotBest Ext Changed>\n                Inactive reason: Not Best in its group - IGP metric\n                Local AS: 64533 Peer AS: 64522\n                Age: 16:59       Metric2: 10\n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n"})}),"\n",(0,o.jsx)(n.h2,{id:"lowest-r-id-or-oldest-active",children:"Lowest R-ID or Oldest Active"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Internal sessions ",(0,o.jsx)(n.strong,{children:"Router-ID"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The inactive route has a router-id 10.100.100.2 which is higher than the 10.100.100.1."}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Inactive reason ",(0,o.jsx)(n.strong,{children:"Not Best in its group - Router ID"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.252.0/24 exact detail \n\ninet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)\n192.168.252.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 2\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:00 \n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.1\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 0\n                Address: 0xc4b5fc4\n                Next-hop reference count: 1\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0, selected\n                Session Id: 0x0\n                State: <NotBest Ext Changed>\n                Inactive reason: Not Best in its group - \n                                 Router ID\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:00 \n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["External sessions ",(0,o.jsx)(n.strong,{children:"Router-ID"})]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["To use the Router-ID as a tie-breaker the command ",(0,o.jsx)(n.strong,{children:"path-selection external-router-id"})," needs to be coinfigured.\nThe inactive route behaves as the internal and has a router-id 10.100.100.2 which is higher than the 10.100.100.1."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Inactive reason ",(0,o.jsx)(n.strong,{children:"Not Best in its group - Router ID"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.252.0/24 exact detail \n\ninet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)\n192.168.252.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 2\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:00       Metric2: 5 \n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.1\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 0\n                Address: 0xc4b5fc4\n                Next-hop reference count: 1\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0, selected\n                Session Id: 0x0\n                State: <NotBest Ext Changed>\n                Inactive reason: Not Best in its group - \n                                 Router ID\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:00\n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"External sessions"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"For Satbility reasons the oldest route is prefered"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["The inactive reason ",(0,o.jsx)(n.strong,{children:"Not Best in its group - Active preferred"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX4# run show route 192.168.252.0/24 exact detail \n\ninet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)\n192.168.252.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 595\n                Address: 0xc4b5f5c\n                Next-hop reference count: 2\n                Source: 10.100.34.1\n                Next hop: 10.100.34.1 via ge-0/0/1.0, selected\n                Session Id: 0x141\n                State: <Active Ext>\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:00 \n                Validation State: unverified \n                Task: BGP_64522.10.100.34.1\n                Announcement bits (2): 0-KRT 4-BGP_RT_Background \n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.3\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Router, Next hop index: 0\n                Address: 0xc4b5fc4\n                Next-hop reference count: 1\n                Source: 10.100.24.1\n                Next hop: 10.100.24.1 via ge-0/0/0.0, selected\n                Session Id: 0x0\n                State: <NotBest Ext Changed>\n                Inactive reason: Not Best in its group - \n                                 Active preferred\n                Local AS: 64533 Peer AS: 64522\n                Age: 1:00 \n                Validation State: unverified \n                Task: BGP_64522.10.100.24.1\n                AS path: 64522 64544 I \n                Accepted\n                Localpref: 100\n                Router ID: 10.100.100.2\n                Thread: junos-main \n"})}),"\n",(0,o.jsx)(n.h2,{id:"cluster-list",children:"Cluster List"}),"\n",(0,o.jsx)(n.p,{children:"The shortest cluster list will be preferred when we have multiple route reflectors."}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Inactive reason ",(0,o.jsx)(n.strong,{children:"Not Best in its group - Cluster list length"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Output TBD \n"})}),"\n",(0,o.jsx)(n.h2,{id:"lowest-peer-ip",children:"Lowest Peer IP"}),"\n",(0,o.jsxs)(n.p,{children:["This is the last tie-breaker we can come this when for load-balancing purposed two routers peer two or more time with eachother.\nThe route has been selected based on the lowest peer ip address, shown as ",(0,o.jsx)(n.strong,{children:"Source"})," in the output."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Inactive reason is ",(0,o.jsx)(n.strong,{children:"Not Best in its group - Update source"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"jcluser@vMX2# run show route 192.168.251.0/24 exact detail \n\ninet.0: 26 destinations, 27 routes (26 active, 0 holddown, 0 hidden)\n192.168.251.0/24 (2 entries, 1 announced)\n        *BGP    Preference: 170/-101\n                Next hop type: Indirect, Next hop index: 0\n                Address: 0xc4b6234\n                Next-hop reference count: 3\n                Source: 10.100.150.1\n                Next hop type: Router, Next hop index: 607\n                Next hop: 10.100.12.1 via ge-0/0/0.0, selected\n                Session Id: 0x143\n                Protocol next hop: 10.100.100.1\n                Indirect next hop: 0xc633184 1048574 \n                                   INH Session ID: 0x144\n                State: <Active Int Ext>\n                Local AS: 64500 Peer AS: 64500\n                Age: 1:37 Metric2: 10 \n                Validation State: unverified \n                ORR Generation-ID: 0 \n                Task: BGP_64500.10.100.150.1\n                Announcement bits (3): 0-KRT 4-BGP_RT_Background \n                                       5-Resolve tree 4 \n                AS path: 64544 I  (Originator)\n                Cluster list:  1.1.1.1\n                Originator ID: 10.100.100.1\n                Accepted\n                Localpref: 100\n                Router ID: 10.100.150.1\n                Thread: junos-main \n         BGP    Preference: 170/-101\n                Next hop type: Indirect, Next hop index: 0\n                Address: 0xc4b6234\n                Next-hop reference count: 3\n                Source: 10.100.150.2\n                Next hop type: Router, Next hop index: 607\n                Next hop: 10.100.12.1 via ge-0/0/0.0, selected\n                Session Id: 0x143\n                Protocol next hop: 10.100.100.1\n                Indirect next hop: 0xc633184 1048574 \n                                   INH Session ID: 0x144\n                State: <NotBest Int Ext>\n                Inactive reason: Not Best in its group - \n                                 Update source\n                Local AS: 64500 Peer AS: 64500\n                Age: 1:37 Metric2: 10 \n                Validation State: unverified \n                ORR Generation-ID: 0 \n                Task: BGP_64500.10.100.150.2\n                AS path: 64544 I  (Originator)\n                Cluster list:  2.2.2.2\n                Originator ID: 10.100.100.1\n                Accepted\n                Localpref: 100\n                Router ID: 10.100.150.2\n                Thread: junos-main \n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}}}]);