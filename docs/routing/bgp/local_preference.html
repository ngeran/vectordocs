<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-routing/bgp/local_preference/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Local Preference | Vector Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ngeran.github.io/vectordocs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ngeran.github.io/vectordocs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ngeran.github.io/vectordocs/docs/routing/bgp/local_preference"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Local Preference | Vector Docs"><meta data-rh="true" name="description" content="Local Preference Power"><meta data-rh="true" property="og:description" content="Local Preference Power"><link data-rh="true" rel="icon" href="/vectordocs/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://ngeran.github.io/vectordocs/docs/routing/bgp/local_preference"><link data-rh="true" rel="alternate" href="https://ngeran.github.io/vectordocs/docs/routing/bgp/local_preference" hreflang="en"><link data-rh="true" rel="alternate" href="https://ngeran.github.io/vectordocs/docs/routing/bgp/local_preference" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Local Preference","item":"https://ngeran.github.io/vectordocs/docs/routing/bgp/local_preference"}]}</script><link rel="alternate" type="application/rss+xml" href="/vectordocs/blog/rss.xml" title="Vector Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/vectordocs/blog/atom.xml" title="Vector Docs Atom Feed"><link rel="stylesheet" href="/vectordocs/assets/css/styles.8bf3e2fe.css">
<script src="/vectordocs/assets/js/runtime~main.278a6937.js" defer="defer"></script>
<script src="/vectordocs/assets/js/main.10291918.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="/vectordocs/"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 19 20" fill="none" focusable="false" aria-hidden="true" class="navbar__brand" imageClassName="navbar__logo" titleClassName="navbar__title text--truncate"><path d="M6.20742 9.02441H0.12651C0.0566404 9.02441 0 9.08105 0 9.15092V9.85095C0 9.92081 0.0566404 9.97745 0.12651 9.97745H6.20742C6.27728 9.97745 6.33392 9.92081 6.33392 9.85095V9.15092C6.33392 9.08105 6.27728 9.02441 6.20742 9.02441Z" fill="currentColor"></path><path d="M18.8754 9.02441H12.7945C12.7246 9.02441 12.668 9.08105 12.668 9.15092V9.85095C12.668 9.92081 12.7246 9.97745 12.7945 9.97745H18.8754C18.9453 9.97745 19.0019 9.92081 19.0019 9.85095V9.15092C19.0019 9.08105 18.9453 9.02441 18.8754 9.02441Z" fill="currentColor"></path><path d="M9.02441 0.12657V6.20747C9.02441 6.27734 9.08105 6.33398 9.15092 6.33398H9.85094C9.92081 6.33398 9.97745 6.27734 9.97745 6.20747V0.12657C9.97745 0.0567002 9.92081 5.96046e-05 9.85094 5.96046e-05H9.15092C9.08105 5.96046e-05 9.02441 0.0567002 9.02441 0.12657Z" fill="currentColor"></path><path d="M9.0332 12.8028V18.8837C9.0332 18.9536 9.08984 19.0103 9.15971 19.0103H9.85974C9.9296 19.0103 9.98624 18.9536 9.98624 18.8837V12.8028C9.98624 12.733 9.9296 12.6763 9.85974 12.6763H9.15971C9.08984 12.6763 9.0332 12.733 9.0332 12.8028Z" fill="currentColor"></path><path d="M8.0754 7.40936C8.07773 7.40703 8.07772 7.40325 8.07539 7.40093L3.17103 2.50499C3.12043 2.45439 3.04452 2.45439 2.99392 2.50499L2.50475 2.99417C2.45415 3.04477 2.45415 3.12068 2.50475 3.17128L7.90425 8.57078C7.98157 8.6481 8.07962 8.72957 8.07962 8.83892V10.1715C8.07962 10.2305 8.05431 10.2811 8.02058 10.3233L2.50475 15.8391C2.45415 15.8897 2.45415 15.9656 2.50475 16.0162L2.99392 16.5054C3.04452 16.556 3.12043 16.556 3.17103 16.5054L8.07118 11.6053L8.3495 11.3269C8.77964 10.8968 9.02422 10.3149 9.02422 9.70762V9.31122C9.02422 8.70397 8.77964 8.12203 8.3495 7.6919L8.0754 7.41779C8.07307 7.41546 8.07307 7.41169 8.0754 7.40936Z" fill="currentColor"></path><path d="M10.99 8.68324C10.99 8.68467 10.9917 8.68538 10.9927 8.68437L16.5058 3.17128C16.5564 3.12067 16.5564 3.04477 16.5058 2.99417L16.0166 2.50499C15.966 2.45439 15.8901 2.45439 15.8395 2.50499L10.9394 7.40514L10.661 7.68346C10.2309 8.1136 9.98633 8.69554 9.98633 9.30279V9.69918C9.98633 10.3064 10.2309 10.8884 10.661 11.3185L10.9394 11.5968L15.8395 16.497C15.8901 16.5476 15.966 16.5476 16.0166 16.497L16.5058 16.0078C16.5564 15.9572 16.5564 15.8813 16.5058 15.8307L11.1063 10.4312C11.029 10.3539 10.9309 10.2724 10.9309 10.1631V8.83048C10.9309 8.77311 10.9548 8.7237 10.9871 8.68226C10.9881 8.68106 10.99 8.68172 10.99 8.68324Z" fill="currentColor"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/vectordocs/docs/routing/bgp/as_path">Posts</a><a class="navbar__item navbar__link" href="/vectordocs/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/ngeran/VectorDocs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/vectordocs/docs/routing/bgp/as_path"><span title="Routing" class="categoryLinkLabel_W154">Routing</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/vectordocs/docs/routing/bgp/as_path"><span title="BGP" class="categoryLinkLabel_W154">BGP</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/vectordocs/docs/routing/bgp/as_path"><span title="AS Path" class="linkLabel_WmDU">AS Path</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/vectordocs/docs/routing/bgp/bgp-attributes"><span title="BGP Attributes" class="linkLabel_WmDU">BGP Attributes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/vectordocs/docs/routing/bgp/bgp-route-selection"><span title="Route Selection" class="linkLabel_WmDU">Route Selection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/vectordocs/docs/routing/bgp/fsm"><span title="Finite State Machine" class="linkLabel_WmDU">Finite State Machine</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/vectordocs/docs/routing/bgp/local_preference"><span title="Local Preference" class="linkLabel_WmDU">Local Preference</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/vectordocs/docs/routing/ospf/lsa1"><span title="OSPF" class="categoryLinkLabel_W154">OSPF</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/vectordocs/docs/junos/tagging"><span title="Junos" class="categoryLinkLabel_W154">Junos</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/vectordocs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Routing</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">BGP</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Local Preference</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Local Preference</h1></header><h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="local-preference-power">Local Preference Power<a href="#local-preference-power" class="hash-link" aria-label="Direct link to Local Preference Power" title="Direct link to Local Preference Power" translate="no">​</a></h3>
<p>Local preference is the highest tiebreaker in the BGP path selection process. If a BGP next hop is reachable and BGP knows multiple routes, BGP always chooses the route with the highest local preference to exit the AS.<br>
<!-- -->The local preference is a <strong>well-known</strong>, <strong>discretionary</strong> attribute, which means it must be supported by all BGP-speaking neighbors but does not have to be included in the BGP update message.<br>
<!-- -->Local preference is also <strong>non-transitive</strong>, meaning it stays within its own internal AS and cannot be advertised to an external BGP neighbor.</p>
<p>Let&#x27;s now see how to configure and influance traffic with Local Preference.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="topology">Topology<a href="#topology" class="hash-link" aria-label="Direct link to Topology" title="Direct link to Topology" translate="no">​</a></h3>
<blockquote>
<p>Taken from Juniper vLabs</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="BGP Topology" src="/vectordocs/assets/images/bgp-topology-diagram-f9739a4a3d06719349a0247521c29a98.jpg" width="919" height="436" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="initial-set-up">Initial set up<a href="#initial-set-up" class="hash-link" aria-label="Direct link to Initial set up" title="Direct link to Initial set up" translate="no">​</a></h3>
<p>vMX5 advertises the same route <strong>192.168.235.0/24</strong> to both vMX3 and vMX2.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX5# run show route advertising-protocol bgp 10.100.25.1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 16 destinations, 16 routes (16 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Prefix  Nexthop       MED     Lclpref    AS path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 192.168.235.0/24        Self                                    I</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[edit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX5# run show route advertising-protocol bgp 10.100.35.1    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 16 destinations, 16 routes (16 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Prefix  Nexthop       MED     Lclpref    AS path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 192.168.235.0/24        Self                                    I</span><br></span></code></pre></div></div>
<p>vMX1 learns the same route from vMX2 and vMX3. Goes throught the Best Path Selection<br>
<!-- -->process and chooses the route from vMX2 because of the lower <strong>Router ID</strong>.<br>
<!-- -->In this case both neighbors advertise the route with the &quot;Localpref&quot; of <strong>100</strong> which is the <strong>default</strong>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX1# run show route 192.168.235.0/24 exact detail </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 13 destinations, 14 routes (13 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.235.0/24 (2 entries, 1 announced)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        *BGP    Preference: 170/-101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop type: Indirect, Next hop index: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Address: 0xc4b5dbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next-hop reference count: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Source: 10.100.100.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop type: Router, Next hop index: 343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop: 100.123.0.1 via fxp0.0, selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Session Id: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Protocol next hop: 10.100.25.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Indirect next hop: 0xc61de84 347 INH Session ID: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                State: &lt;Active Int Ext&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Local AS: 64522 Peer AS: 64522</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Age: 8:04 Metric2: 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Validation State: unverified </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Task: BGP_64522.10.100.100.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Announcement bits (2): 0-KRT 5-Resolve tree 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                AS path: 64544 I </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Accepted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Localpref: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Router ID: 10.100.100.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread: junos-main </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         BGP    Preference: 170/-101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop type: Indirect, Next hop index: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Address: 0xc4b5e8c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next-hop reference count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Source: 10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop type: Router, Next hop index: 343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop: 100.123.0.1 via fxp0.0, selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Session Id: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Protocol next hop: 10.100.35.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Indirect next hop: 0xc61e004 - INH Session ID: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                State: &lt;NotBest Int Ext Changed&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Inactive reason: Not Best in its group - Router ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Local AS: 64522 Peer AS: 64522</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Age: 8:04 Metric2: 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Validation State: unverified </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Task: BGP_64522.10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                AS path: 64544 I </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Accepted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Localpref: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Router ID: 10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread: junos-main </span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX3# run show route protocol bgp   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 17 destinations, 18 routes (17 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ = Active Route, - = Last Active, * = Both</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.235.0/24   *[BGP/170] 00:20:44, localpref 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      AS path: 64544 I, validation-state: unverified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &gt;  to 10.100.35.2 via ge-0/0/0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    [BGP/170] 00:20:43, localpref 100, from 10.100.100.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      AS path: 64544 I, validation-state: unverified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &gt;  to 100.123.0.1 via fxp0.0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration" translate="no">​</a></h3>
<p>Now lets create a policy to change the Local_Pref value to <strong>200</strong> and observe the impact.</p>
<blockquote>
<p>Change the the Local_Pref for all inbounds routes</p>
</blockquote>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX3# show policy-options </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy-statement SET_LOCAL_PREF {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    term ROUTE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from next-hop 10.100.35.2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        then {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            local-preference 200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            accept;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p>Change the the Local_Pref for a specific inbound route.</p>
</blockquote>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX3# show policy-options </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy-statement SET_LOCAL_PREF {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    term ROUTE {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            route-filter 192.168.235.0/24 exact;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        then {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            local-preference 200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            accept;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p>Apply the policy inbound (<strong>import</strong>) to change the AS exit point.</p>
</blockquote>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX3# show protocols bgp group to-AS64544 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type external;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import SET_LOCAL_PREF; &lt;-- Inbound </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peer-as 64544;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">neighbor 10.100.35.2;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-result">The Result<a href="#the-result" class="hash-link" aria-label="Direct link to The Result" title="Direct link to The Result" translate="no">​</a></h3>
<p>After applying the policy vMX1 chooses the route learned from vMX3 because of the higher Local_Pref value.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX1# run show route 192.168.235.0/24 exact detail    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 13 destinations, 13 routes (13 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.235.0/24 (1 entry, 1 announced)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        *BGP    Preference: 170/-201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop type: Indirect, Next hop index: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Address: 0xc4b5e8c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next-hop reference count: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Source: 10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop type: Router, Next hop index: 343</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop: 100.123.0.1 via fxp0.0, selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Session Id: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Protocol next hop: 10.100.35.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Indirect next hop: 0xc61e004 348 INH Session ID: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                State: &lt;Active Int Ext&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Local AS: 64522 Peer AS: 64522</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Age: 13 Metric2: 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Validation State: unverified </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Task: BGP_64522.10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Announcement bits (2): 0-KRT 5-Resolve tree 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                AS path: 64544 I </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Accepted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Localpref: 200 &lt;--- Higher than the default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Router ID: 10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread: junos-main </span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX1# run show route protocol bgp   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 13 destinations, 13 routes (13 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ = Active Route, - = Last Active, * = Both</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.235.0/24   *[BGP/170] 00:01:32, localpref 200, from 10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      AS path: 64544 I, validation-state: unverified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &gt;  to 100.123.0.1 via fxp0.0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="advertise-to-ebgp-non-transitive">Advertise to eBGP (non-transitive)<a href="#advertise-to-ebgp-non-transitive" class="hash-link" aria-label="Direct link to Advertise to eBGP (non-transitive)" title="Direct link to Advertise to eBGP (non-transitive)" translate="no">​</a></h3>
<p>vMX3 has the route <strong>192.168.123.0/24</strong> with <strong>localpref</strong> of  <strong>123</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX3# run show route protocol bgp                         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 19 destinations, 20 routes (19 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ = Active Route, - = Last Active, * = Both</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.123.0/24    [BGP/170] 00:04:39, localpref 123, from 10.100.100.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      AS path: I, validation-state: unverified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &gt;  to 10.100.13.1 via ge-0/0/4.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.235.0/24   *[BGP/170] 00:53:00, localpref 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      AS path: 64544 I, validation-state: unverified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &gt;  to 10.100.35.2 via ge-0/0/0.0</span><br></span></code></pre></div></div>
<blockquote>
<p>When the route is advertised to a neighbor with a diffrent AS.</p>
</blockquote>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX3# run show route advertising-protocol bgp 10.100.35.2 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 19 destinations, 20 routes (19 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Prefix  Nexthop       MED     Lclpref    AS path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 192.168.123.0/24        Self                 1                  I</span><br></span></code></pre></div></div>
<blockquote>
<p>The Local Preference resets back to the default value.</p>
</blockquote>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jcluser@vMX5# run show route protocol bgp detail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet.0: 17 destinations, 17 routes (17 active, 0 holddown, 0 hidden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.123.0/24 (1 entry, 1 announced)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        *BGP    Preference: 170/-101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop type: Router, Next hop index: 596</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Address: 0xc4b5f5c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next-hop reference count: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Source: 10.100.35.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Next hop: 10.100.35.1 via ge-0/0/0.0, selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Session Id: 0x141</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                State: &lt;Active Ext&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Local AS: 64544 Peer AS: 64522</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Age: 1:56 Metric: 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Validation State: unverified </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Task: BGP_64522.10.100.35.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Announcement bits (3): 0-KRT 4-BGP_RT_Background </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       5-Resolve tree 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                AS path: 64522 I </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Accepted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Localpref: 100 &lt;-- Original Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Router ID: 10.100.100.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread: junos-main </span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/vectordocs/docs/tags/bgp">BGP</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/vectordocs/docs/tags/routing">Routing</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/vectordocs/docs/tags/juniper">Juniper</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/vectordocs/docs/tags/attributes">Attributes</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/ngeran/VectorDocs/tree/main/docs/routing/bgp/local_preference/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/vectordocs/docs/routing/bgp/fsm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Finite State Machine</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/vectordocs/docs/routing/ospf/lsa1"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Type 1 - Router LSA</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#local-preference-power" class="table-of-contents__link toc-highlight">Local Preference Power</a></li><li><a href="#topology" class="table-of-contents__link toc-highlight">Topology</a></li><li><a href="#initial-set-up" class="table-of-contents__link toc-highlight">Initial set up</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#the-result" class="table-of-contents__link toc-highlight">The Result</a></li><li><a href="#advertise-to-ebgp-non-transitive" class="table-of-contents__link toc-highlight">Advertise to eBGP (non-transitive)</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer_xBL4"><p class="copyright_g70o">Copyright © 2026 VectorDocs @ ngeran[io]</p></footer></div>
</body>
</html>